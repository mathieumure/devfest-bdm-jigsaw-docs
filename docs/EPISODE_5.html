<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Episode V - Yoda contre-attaque | Star Jigsaw - La guerre des modules</title>
    <meta name="description" content="Hand&#39;s on Jigsaw @ Devfest">
    
    
    <link rel="preload" href="/devfest-bdm-jigsaw-docs/assets/css/0.styles.85035bb6.css" as="style"><link rel="preload" href="/devfest-bdm-jigsaw-docs/assets/js/app.1aea4613.js" as="script"><link rel="preload" href="/devfest-bdm-jigsaw-docs/assets/js/9.3d638fe5.js" as="script"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/2.f18bfe2d.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/3.69555ae4.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/4.6d72add6.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/5.0bc599f4.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/6.f76b0ee8.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/7.b85338de.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/8.70f08d59.js"><link rel="prefetch" href="/devfest-bdm-jigsaw-docs/assets/js/10.bbbb9499.js">
    <link rel="stylesheet" href="/devfest-bdm-jigsaw-docs/assets/css/0.styles.85035bb6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/devfest-bdm-jigsaw-docs/" class="home-link router-link-active"><!----> <span class="site-name">Star Jigsaw - La guerre des modules</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/devfest-bdm-jigsaw-docs/C3P0_HELP.html" class="nav-link">C3P0 Help</a></div><div class="nav-item"><a href="https://github.com/mathieumure/devfest-bdm-jigsaw-webapp" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Frontend
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/louiznk/hands-on-jigsaw-bdm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/devfest-bdm-jigsaw-docs/C3P0_HELP.html" class="nav-link">C3P0 Help</a></div><div class="nav-item"><a href="https://github.com/mathieumure/devfest-bdm-jigsaw-webapp" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Frontend
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/louiznk/hands-on-jigsaw-bdm" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/devfest-bdm-jigsaw-docs/" class="sidebar-link">A long time ago in a galaxy far far away...</a></li><li><a href="/devfest-bdm-jigsaw-docs/EPISODE_1.html" class="sidebar-link">Episode I - La Menace de la configuration</a></li><li><a href="/devfest-bdm-jigsaw-docs/EPISODE_2.html" class="sidebar-link">Episode II - Le guerre du Hello World</a></li><li><a href="/devfest-bdm-jigsaw-docs/EPISODE_3.html" class="sidebar-link">Episode III - La revanche des Sith Maven</a></li><li><a href="/devfest-bdm-jigsaw-docs/EPISODE_4.html" class="sidebar-link">Episode IV - Gradle, un Nouvel Espoir</a></li><li><a href="/devfest-bdm-jigsaw-docs/EPISODE_5.html" class="active sidebar-link">Episode V - Yoda contre-attaque</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/devfest-bdm-jigsaw-docs/EPISODE_5.html#une-version-sans-vertx" class="sidebar-link">Une version sans vertx</a></li><li class="sidebar-sub-header"><a href="/devfest-bdm-jigsaw-docs/EPISODE_5.html#jlink" class="sidebar-link">Jlink</a></li><li class="sidebar-sub-header"><a href="/devfest-bdm-jigsaw-docs/EPISODE_5.html#image-docker" class="sidebar-link">Image Docker</a></li></ul></li><li><a href="/devfest-bdm-jigsaw-docs/C3P0_HELP.html" class="sidebar-link">C3P0_H3LP</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="episode-v-yoda-contre-attaque"><a href="#episode-v-yoda-contre-attaque" aria-hidden="true" class="header-anchor">#</a> Episode V - Yoda contre-attaque</h1> <p><img src="/devfest-bdm-jigsaw-docs/assets/img/yoda.649a9b55.jpeg" alt="Yoda"></p> <p>Vous êtes maintenant un maître Jedi et maîtriser complètement Jigsaw. Vous n'avez plus besoin de maître et allez maintenant partir seul pour protéger la galaxie.</p> <div class="language-sh extra-class"><pre class="language-text"><code>cd hands-on-jigsaw-devfest/Yoda-style
</code></pre></div><h2 id="une-version-sans-vertx"><a href="#une-version-sans-vertx" aria-hidden="true" class="header-anchor">#</a> Une version sans vertx</h2> <p>Le maitre de l'Ordre Jedi, Mace Windu, vous a préparé une version allégée du serveur HTTP sans Vertx.</p> <h2 id="jlink"><a href="#jlink" aria-hidden="true" class="header-anchor">#</a> Jlink</h2> <p>La maitrise de Jlink est nécessaire à tous maîtres Jedi.
Jlink est un outil permettant de viser la pureté de la force de la JVM en enlevant toutes pensées inutiles qui pourraient obscurcir le démarrage de la JVM.</p> <p>Jlink permet de créer des JRE packagées exclusivement avec les modules nécessaires à votre application.</p> <p>Yoda vous a laissé ces indications pour que vous trouviez en vous les modules à utiliser.</p> <p>Avec BASE_DIR = le répertoire de travail de votre projet.</p> <h3 id="module-path-module-path"><a href="#module-path-module-path" aria-hidden="true" class="header-anchor">#</a> Module Path (--module-path )</h3> <ul><li>Les modules du JDK sont dans ${JAVA_HOME}/jmods</li> <li>Les jar générés par gradle sont dans :
<ul><li>${BASE_DIR}/api-starwars/build/libs/api-starwars.jar</li> <li>${BASE_DIR}/api-starwars-local-impl/build/libs/api-starwars-local-impl.jar</li> <li>${BASE_DIR}/starwars-http-server/build/libs/starwars-http-server.jar</li> <li>${BASE_DIR}/diffutils/build/libs/diffutils.jar</li> <li>${BASE_DIR}/fuzzywuzzy/build/libs/fuzzywuzzy.jar</li></ul></li></ul> <h3 id="la-liste-des-modules-a-ajouter-add-modules"><a href="#la-liste-des-modules-a-ajouter-add-modules" aria-hidden="true" class="header-anchor">#</a> La liste des modules à ajouter (--add-modules)</h3> <p>Votre JRE optimisé devra contenir les modules suivants :</p> <ul><li>org.zenika.handson.jigsaw.api.local.impl</li> <li>org.zenika.handson.jigsaw.http</li></ul> <p>(les dépendances nécessaires sont obtenues par transitivité)</p> <h3 id="le-lanceur-launcher-optionnel"><a href="#le-lanceur-launcher-optionnel" aria-hidden="true" class="header-anchor">#</a> Le lanceur (--launcher) (optionnel)</h3> <p>Votre JRE optimisé peut contenir un script de lancement de votre application. Votre &quot;main class&quot; sera ici dans le module <code>org.zenika.handson.jigsaw.http</code> et sera <code>org.zenika.handson.jigsaw.http.Application</code>.</p> <div class="language-sh extra-class"><pre class="language-text"><code>--launcher death-star-launcher=org.zenika.handson.jigsaw.http/org.zenika.handson.jigsaw.http.Application
</code></pre></div><p><strong>CONSEILS DE MAITRE YODA</strong></p> <blockquote><p>Sur la page <a href="http://localhost:8080/infos" target="_blank" rel="noopener noreferrer">infos<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, moins de modules tu verras, plus forte ta maîtrise sera.</p></blockquote> <blockquote><p>Avec la commande <code>./$$nom_de_votre_jre_jlink_/bin/java --list-modules</code> la sagesse tu connaitras</p></blockquote> <h2 id="image-docker"><a href="#image-docker" aria-hidden="true" class="header-anchor">#</a> Image Docker</h2> <p>Pour parvenir au rang de grand maitre et approcher à la sagesse de Yoda, il faut maitriser le pouvoir de containerisation.
Vous devez créer une image minimaliste en utilisant Jlink dans une première phase de compilation</p> <p>Pour cela appuyer vous sur les multi-build de docker avec comme images :</p> <ul><li><code>openjdk:11-jdk-oracle</code> pour le build</li> <li><code>debian:sid-slim</code> pour l'image final</li></ul> <p><strong>C3P0_H3LP</strong></p> <blockquote><p>Lancer le build des jar depuis l'image 0 ainsi ./gradlew --no-daemon clean jar</p></blockquote></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/devfest-bdm-jigsaw-docs/EPISODE_4.html" class="prev">
          Episode IV - Gradle, un Nouvel Espoir
        </a></span> <span class="next"><a href="/devfest-bdm-jigsaw-docs/C3P0_HELP.html">
          C3P0_H3LP
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/devfest-bdm-jigsaw-docs/assets/js/9.3d638fe5.js" defer></script><script src="/devfest-bdm-jigsaw-docs/assets/js/app.1aea4613.js" defer></script>
  </body>
</html>
